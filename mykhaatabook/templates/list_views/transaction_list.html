{% extends "home/layout.html" %}

{% block breadcrumb %}
 
  <li class="breadcrumb-item"><a href="{% url 'index' %}">Home</a></li>
  <li class="breadcrumb-item active" aria-current="page">All Transaction</li>

  {% endblock %}

{% block content %}
  <h1>Transaction List</h1>

  {% include 'partials/messages.html' %}

  {% if page_obj %}

  <div class="row">
    <div class="col">
      <div class="card card-body">
        <form action="{% url 'search_results' %}" method="get">
          
          <div class="row">

            <div class="col">
              <input class="form-control form-control-sm" type="text" placeholder="Search Bar" name='search'>
            </div>

            <div class="col">
              <input class="form-control form-control-sm btn-sm btn-info"  type="submit" name="" value="Search" id="">
            </div>

          </div>
     


        </form>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <div class="card card-body">
        <form action="{% url 'date_range'%}" method="get" class="align-right">
          <div class="row">
            <div class="col" >
              <input class="form-control form-control-sm" type="date" name='start'>
            </div>

            <div class="col">
              <input  class="form-control form-control-sm" type="date" name='end'>
            </div>

            <div class="col" >
              <input class=" form-control form-control-sm btn btn-info" type="submit" name="date_range"  id="">
            </div>
          </div>


        </form>
      </div>
    </div>
  </div>

  
  
  <table class="table table-dark table-striped table-hover">
    <thead>

      <tr>
        <th scope="col">Date</th>
        <th scope="col">Reference Number</th>
        <th scope="col">Details</th>
        <th scope="col">Credit Account</th>
        <th scope="col">Debit Account</th>
        <th scope="col">Credit</th>
        <th scope="col">Debit</th>
        <th scope="col">Balance</th>
        <th scope="col">Slip</th>
      </tr>
    </thead>
    <tbody>
      {% for trans in page_obj %}
      <tr>
        <th scope="row">{{ trans.transaction_date | date:"F d Y" }}</th>
        <td>{{ trans.refernce_number }}</td>
        <td>{{ trans.transaction_detail }}</td>
        <td>{{ trans.account }}</td>
        <td>{{ trans.bank }}</td>
        <td>
          {% if trans.transaction_type == credit  %}
          {{ trans.amount }}
          {% endif %}
        </td>
        <td class="text-danger ">
          {% if trans.transaction_type == debit  %}
          {{ trans.amount }}
          {% endif %}
        </td>

        <td >
          {{ trans.balance_after_transaction }}
        </td>
        <td><a style="text-decoration: none;" class="link-light" href="{{ trans.get_absolute_url }}"> 
          <div class="p-0 mb-2 bg-dark bg-gradient ">
          Slip {{trans.id}}
        </div> </a></td>

        
      </tr>

      {% endfor %}
    </tbody>
    {% if not page_obj.has_next %}
    <tfoot>
      
    <tr>
       
      <td colspan="5">TOTAL CREDIT/DEBIT:</td>
      <td colspan="1">{{total_credit}}</td>
      <td colspan="1" class="text-danger">{{total_debit}}</td>
      <td colspan="2"></td>

    </tr>
    
    <tr>
       
      <td colspan="7">TOTAL BANK:</td>
      <td colspan="2">{{total_bank_balance}}</td>
      
    </tr>

    <tr>
       
      <td colspan="7">TOTAL CLEARING:</td>
      <td colspan="2">{{total_clearing}}</td>
      
    </tr>

    <tr>
       
      <td colspan="7">TOTAL HAWALA:</td>
      <td colspan="2">{{total_hawala}}</td>
      
    </tr>
  </tfoot>

  {% endif %}
  
  </table>
     
  <div class="col-md-2">
    <a href="{% url 'add-transaction' %}" class="btn btn-primary">
      <i class="bi bi-plus-circle"></i>   
         Add Transaction</a>
  </div>


  <div class="col-4 offset-4">
    <nav aria-label="...">
      <ul class="pagination">
  
        {% if page_obj.has_previous %}
          <li class="page-item">
            <a href="?page={{ page_obj.previous_page_number }}" class="page-link">Previous</a>
          </li>
          <li>
            <a class="page-link" href="?page={{ page_obj.previous_page_number }}">
              {{ page_obj.previous_page_number }}
            </a>
          </li>
        {% else %}
          <li class="page-item disabled">
            <span class="page-link">Previous</span>
          </li>
        {% endif %}
  
        <li class="page-item active">
          <span class="page-link">{{ page_obj.number }}</span>
        </li>
  
        {% if page_obj.has_next %}
          <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.next_page_number }}">
              {{ page_obj.next_page_number }}
            </a>
          </li>
          <li class="page-item ">
            <a class="page-link" href="?page={{ page_obj.next_page_number }}">Next</a>
          </li>
        {% else %}
          <li class="page-item disabled">
            <span class="page-link">Next</span>
          </li>
        {% endif %}
  
      </ul>
    </nav>
  </div>

  {% else %}

  <p>There are no transactions in the app.</p>




{% endif %} 



{% endblock %}